/*
* FileDrop v1.0.0 Copyright (c) 2016 AJ Savino
* https://github.com/koga73/FileDrop
* MIT LICENSE
*/
if(!OOP){var OOP=function(){var e={namespace:function(e,n){for(var t=e.split("."),r=t.length,a=window,v=0;r>v;v++){var i=t[v];a[i]=v==r-1?n:a[i]||{},a[i]._type=t.slice(0,v+1).join("."),a=a[i]}return n},extend:function(n,t){if("undefined"==typeof n)throw"Error base object is undefined";if(!e._isFunction(n))throw"Error base object must be a function";var r=new n;for(var a in r)"undefined"==typeof t[a]&&(t[a]=r[a]);var v=r;do v._interface=t,v=v._super;while("undefined"!=typeof v);return t._super=r,t},construct:function(n,t,r){var a=null;arguments&&arguments.callee&&arguments.callee.caller&&(a=arguments.callee.caller._type,n._type=a),n._isType=function(t){return e.isType(n,t)},n._interface=n;for(var v in t)e._isFunction(n[v])?n[v](t[v]):n[v]=t[v];return 1==r&&(n._eventHandlers||(n._eventHandlers={}),n.addEventListener||(n.addEventListener=e._addEventListener),n.removeEventListener||(n.removeEventListener=e._removeEventListener),n.dispatchEvent||(n.dispatchEvent=e._dispatchEvent)),n},event:function(e,n){var t=null;try{t=new CustomEvent(e)}catch(r){document.createEventObject?(t=document.createEventObject("Event"),t.initCustomEvent&&t.initCustomEvent(e,!0,!0)):t={}}return t._type=e,t._data=n,t},addEventListener:function(n,t,r){n._eventHandlers||(n._eventHandlers={}),t=t.split(",");for(var a=t.length,v=0;a>v;v++){var i=t[v];if(n.addEventListener)r=e._addEventHandler(n,i,r),n.addEventListener(i,r);else if(n.attachEvent){var d=function(){r(window.event)};d.handler=r,d=e._addEventHandler(n,i,d),n.attachEvent("on"+i,d)}else"undefined"!=typeof jQuery?(r=e._addEventHandler(n,i,r),jQuery.on(i,r)):(n.addEventListener=e._addEventListener,n.addEventListener(i,r))}},_addEventListener:function(n,t){t._isCustom=!0,e._addEventHandler(this,n,t)},_addEventHandler:function(e,n,t){e._eventHandlers[n]||(e._eventHandlers[n]=[]);for(var r=e._eventHandlers[n],a=r.length,v=0;a>v;v++){if(r[v]===t)return t;if(r[v].handler&&r[v].handler===t)return r[v]}return r.push(t),t},removeEventListener:function(n,t,r){n._eventHandlers||(n._eventHandlers={}),t=t.split(",");for(var a=t.length,v=0;a>v;v++){var i,d=t[v];i="undefined"==typeof r?n._eventHandlers[d]||[]:[r];for(var s=i.length,o=0;s>o;o++){var r=i[o];n.removeEventListener?(r=e._removeEventHandler(n,d,r),n.removeEventListener(d,r)):n.detachEvent?(r=e._removeEventHandler(n,d,r),n.detachEvent("on"+d,r)):"undefined"!=typeof jQuery?(r=e._removeEventHandler(n,d,r),jQuery.off(d,r)):(n.removeEventListener=e._removeEventListener,n.removeEventListener(d,r))}}},_removeEventListener:function(n,t){n=n.split(",");for(var r=n.length,a=0;r>a;a++){var v,i=n[a];v="undefined"==typeof t?this._eventHandlers[i]||[]:[t];for(var d=v.length,s=0;d>s;s++){var t=v[s];t._isCustom=!1,e._removeEventHandler(this,i,t)}}},_removeEventHandler:function(e,n,t){e._eventHandlers[n]||(e._eventHandlers[n]=[]);for(var r=e._eventHandlers[n],a=r.length,v=0;a>v;v++){if(r[v]===t)return r.splice(v,1)[0];if(r[v].handler&&r[v].handler===t)return r.splice(v,1)[0]}},dispatchEvent:function(n,t){n._eventHandlers||(n._eventHandlers={}),n.dispatchEvent?n.dispatchEvent(t):n.fireEvent?n.fireEvent("on"+type,t):"undefined"!=typeof jQuery?jQuery(n).trigger(jQuery.Event(t._type,{_type:t._type,_data:t._data})):(n.dispatchEvent=e._dispatchEvent,n.dispatchEvent(t))},_dispatchEvent:function(n){e._dispatchEventHandlers(this,n)},_dispatchEventHandlers:function(e,n){var t=e._eventHandlers[n._type];if(t)for(var r=t.length,a=0;r>a;a++)t[a](n)},isType:function(e,n){var t=e;do{if(t._type==n||t._type==n._type)return!0;t=t._super}while("undefined"!=typeof t);return!1},_isFunction:function(e){return e&&"[object Function]"==Object.prototype.toString.call(e)}};return{Namespace:e.namespace,Extend:e.extend,Construct:e.construct,Event:e.event,addEventListener:e.addEventListener,removeEventListener:e.removeEventListener,dispatchEvent:e.dispatchEvent,isType:e.isType}}();}
OOP.Namespace("FileDrop",function(e){var n=null,t={DRAG_LEAVE_TIMEOUT:2500,CLASS_DRAG_BEGIN:"drag-begin",CLASS_DRAG_OVER:"drag-over"},r={container:e,_fileInput:null,_dragLeaveTimeout:null},a={init:function(){var e=n.container;if(!e)throw new Error("Container does not exist");var t=n.container.querySelector("input[type='file']");if(!t)throw new Error("input[type='file'] not found in container");r._fileInput=t,OOP.addEventListener(window,"dragenter",a._handler_window_dragEnter),OOP.addEventListener(window,"dragleave",a._handler_window_dragLeave),OOP.addEventListener(t,"dragenter",a._handler_fileInput_dragEnter),OOP.addEventListener(t,"dragleave",a._handler_fileInput_dragLeave),OOP.addEventListener(t,"drop",a._handler_fileInput_drop),OOP.addEventListener(t,"change",a._handler_fileInput_change)},destroy:function(){var e=r._dragLeaveTimeout;e&&(clearTimeout(e),r._dragLeaveTimeout=null);var o=r._fileInput;o&&(OOP.removeEventListener(o,"dragenter",a._handler_fileInput_dragEnter),OOP.removeEventListener(o,"dragleave",a._handler_fileInput_dragLeave),OOP.removeEventListener(o,"drop",a._handler_fileInput_drop),OOP.removeEventListener(o,"change",a._handler_fileInput_change),r._fileInput=null);var _=n.container;_&&i.removeClass(_,t.CLASS_DRAG_BEGIN+" "+t.CLASS_DRAG_OVER),OOP.removeEventListener(window,"dragenter",a._handler_window_dragEnter),OOP.removeEventListener(window,"dragleave",a._handler_window_dragLeave)},_handler_window_dragEnter:function(e){i.addClass(n.container,t.CLASS_DRAG_BEGIN)},_handler_window_dragLeave:function(e){r._dragLeaveTimeout&&(clearTimeout(r._dragLeaveTimeout),r._dragLeaveTimeout=null),r._dragLeaveTimeout=setTimeout(function(){r._dragLeaveTimeout=null,i.removeClass(n.container,t.CLASS_DRAG_BEGIN+" "+t.CLASS_DRAG_OVER)},t.DRAG_LEAVE_TIMEOUT)},_handler_fileInput_dragEnter:function(e){i.addClass(n.container,t.CLASS_DRAG_OVER)},_handler_fileInput_dragLeave:function(e){i.removeClass(n.container,t.CLASS_DRAG_OVER)},_handler_fileInput_drop:function(e){e.preventDefault(),e.stopPropagation(),i.removeClass(n.container,t.CLASS_DRAG_BEGIN+" "+t.CLASS_DRAG_OVER),a._gotFile(e.dataTransfer.files[0])},_handler_fileInput_change:function(e){a._gotFile(e.target.files[0])},_gotFile:function(e){n.dispatchEvent(new OOP.Event(FileDrop.EVENT_FILE,e))}},i=function(){return"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),{addClass:function(e,n){var t=(e.getAttribute("class")||"").split(" ");n=n.split(" ");for(var r in n){for(var a=t.length,i=0;a>i&&t[i]!=n[r].trim();i++);i==a&&t.push(n[r].trim())}e.setAttribute("class",t.join(" ").trim())},removeClass:function(e,n){var t=(e.getAttribute("class")||"").split(" ");n=n.split(" ");for(var r in n)for(var a=t.length,i=0;a>i;i++)t[i]==n[r].trim()&&(t.splice(i,1),a--,i--);e.setAttribute("class",t.join(" ").trim())},hasClass:function(e,n){var t=(e.getAttribute("class")||"").split(" ");n=n.split(" ");var r=0;for(var a in n)for(var i=t.length,o=0;i>o;o++)if(t[o]==n[a].trim()){r++;break}return r==n.length?!0:!1}}}();return n=OOP.Construct({container:r.container,init:a.init,destroy:a.destroy},null,!0),n.init(),n}),OOP.Namespace("FileDrop.EVENT_FILE","file");